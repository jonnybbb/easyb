<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <!--Launch Config -->
   <extension point="org.eclipse.debug.core.launchConfigurationTypes">
	    <launchConfigurationType
	        name="Easyb Story"
	        delegate="org.easyb.launch.launch.BehaviourLaunchConfigurationDelegate"
	        modes="run, debug"               
	        id="org.easyb.easybplugin.launch.EasybLaunchConfigurationDelegate">        
	    </launchConfigurationType>
	</extension>
   
	<extension point="org.eclipse.debug.ui.launchConfigurationTypeImages">
	    <launchConfigurationTypeImage
	        icon="resources/images/icons/easyb.png"
	        configTypeID="org.easyb.easybplugin.launch.EasybLaunchConfigurationDelegate"
	        id="org.easyb.easybplugin.launch.easyblaunch.img">
	    </launchConfigurationTypeImage>
	</extension>
	
	<extension point="org.eclipse.debug.ui.launchConfigurationTabGroups">
	    <launchConfigurationTabGroup
	        type="org.easyb.easybplugin.launch.EasybLaunchConfigurationDelegate"
	        class="org.easyb.launch.launch.BehaviourLaunchConfigurationTabGroup"
	        id="org.easyb.easybplugin.launch.EasybLaunchConfigurationTabGroup">
	    </launchConfigurationTabGroup>
	</extension>
	
	<!--Launch short cut-->
	<extension point="org.eclipse.debug.ui.launchShortcuts">
	   <Shortcut
	      id="org.easyb.easybplugin.launch.EasybLaunchShortcut"
	      class="org.easyb.easybplugin.launch.EasybLaunchShortcut"
	 		label="easyb story"
	 		icon="resources/images/icons/easyb.png"
	 		modes="run, debug">
 
            <contextualLaunch>
           		<enablement>
	           		<with variable="selection">
		               <count value="1"/>
		               <iterate>
		                 <or>
		                   <!--test property="org.eclipse.debug.ui.matchesPattern" value="*.story"/-->
			        	  <test property="org.eclipse.debug.ui.matchesContentType" value="org.easyb.eclipse.contenttype.groovystory"/>
			        	  <test property="org.eclipse.debug.ui.matchesContentType" value="org.easyb.eclipse.contenttype.story"/>
		                 </or>
		               </iterate>
		             </with>
           			
           		</enablement>
           		<contextLabel label="Run easyb story" mode="run"/>
           		<contextLabel label="Debug easyb story" mode="debug"/>
           		
        	</contextualLaunch>
            <configurationType id="org.easyb.easybplugin.launch.EasybLaunchConfigurationDelegate"/>
	
	   </Shortcut>
	 </extension>
	 
	<!--<extension point="org.eclipse.ui.editors"> 
		<editor
	      class="org.eclipse.ui.editors.text.TextEditor"
	      default="false"
	      extensions="story"
	      icon="resources/images/icons/easyb.png"
	      id="org.easy.eclipse.ui.dummyEditor"
	      name="easyb story editor">
		</editor> 
	</extension>-->
	
   <extension
         point="org.eclipse.core.contenttype.contentTypes">
      <content-type
            file-extensions="story,specification"
            id="org.easyb.eclipse.contenttype.story"
            name="easyb story"
            priority="normal">
      </content-type>
      <content-type
            file-extensions="groovy"
            id="org.easyb.eclipse.contenttype.groovystory"
            name="easyb groovy story"
            priority="low">
      </content-type>
   </extension>

   <extension
         point="org.eclipse.ui.commands">
      <command 
            categoryId="org.eclipse.debug.ui.category.run"
            id="org.easyb.easybplugin.launch.EasybLaunchShortcut.run"
            name="run easby story">
      </command>
   </extension>	
   
   <extension
         point="org.eclipse.ui.bindings">
      <key
            commandId="org.easyb.easybplugin.launch.EasybLaunchShortcut.run"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
            sequence="M2+M3+X S">
      </key>
   </extension>	
	
<!--New Behaviour Wizard TODO COuld move to seperate plugin-->
   <extension
      point = "org.eclipse.ui.newWizards">
		<category
		   id = "org.eclipse.ui.easyb"
		   name="easyb">
		</category>
	 	<wizard
		   id = "org.easyb.easybplugin.newbehaviour.NewStoryWizard"
	      	   name = "Story"
		   class="org.easyb.launch.newbehaviour.NewStoryWizard"
		   category="org.eclipse.ui.easyb"
		   icon="resources/images/logo.png">
	    	   <description>"Creates a new easyb story"</description>
		   <selection class="org.eclipse.core.resources.IResource"/>
		</wizard>
		<wizard
		   id = "org.easyb.easybplugin.newbehaviour.NewSpecificationWizard"
	      	   name = "Specification"
		   class="org.easyb.launch.newbehaviour.NewSpecificationWizard"
		   category="org.eclipse.ui.easyb"
		   icon="resources/images/logo.png">
	    	   <description>"Creates a new easyb specification"</description>
		   <selection class="org.eclipse.core.resources.IResource"/>
		</wizard>
	</extension>
	
	<!--Behaviour editor TODO could move to seperate plugin-->
	<extension
         point="org.eclipse.ui.editors">
      <editor
            name="Behaviour editor"
            icon="resources/images/logo.png"
            extensions="story,groovy"
            contributorClass="org.easyb.launch.editor.BehaviourActionContributor"
            class="org.easyb.launch.editor.BehaviourEditor"
            id="org.easyb.easybplugin.editor.BehaviourEditor">
      </editor>
   </extension>
   
   <!--Used by the TextFileDocumentProvider to partition the document-->
   <extension point="org.eclipse.core.filebuffers.documentSetup">
   	<participant
   		class="org.easyb.launch.editor.BehaviourDocumentSetup"
   		contentTypeId="org.easyb.eclipse.contenttype.story" >
	</participant>
	<participant
   		class="org.easyb.launch.editor.BehaviourDocumentSetup"
   		contentTypeId="org.easyb.eclipse.contenttype.groovystory" >
	</participant>   	
   </extension>

</plugin>
